friendly_name: Clients First Seen
description: |-
  Picks out just the first observations per client based on:
  - Main ping for most attributes.
  - New profile ping for attributes that are not available in
  the main ping.
  - The earliest value for attribution and download token from
  the pings: main, new_profile and first_shutdown.

  It should be accessed through the user-facing view
  `telemetry.clients_first_seen`.

  The query for this table overwrites the whole table instead of writing to
  a single partition, so manual backfills must use parameter --no_partition.
owners:
- lvargas@mozilla.com
labels:
  application: firefox
  incremental: true
  schedule: daily
  depends_on_past: true
scheduling:
  dag_name: bqetl_analytics_tables
  task_name: clients_first_seen_v2
  depends_on_past: true
  date_partition_parameter: null
  parameters:
  - submission_date:DATE:{{ds}}
bigquery:
  time_partitioning:
    type: day
    field: first_seen_date
    require_partition_filter: false
  clustering:
    fields:
    - normalized_channel
    - sample_id
    - country
    - normalized_os
