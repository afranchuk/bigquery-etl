friendly_name: Clients First Seen
description: |-
  Picks out just the first observations per client.
  - Each attribute is retrieved from the ping that reports it
  first: Main, New profile or First Shutdown ping, and only
  updated from pings reported on the first-seen date.

  This table should be accessed through the user-facing view
  `telemetry.clients_first_seen`.

  The query for this table overwrites the whole table instead of
  writing to a single partition, so manual backfills must use
  the parameter --no_partition.

  To initialize the table:
  - Run bqetl query initialize <path>/clients_first_seen_v2/query.sql
  - Alternatively, use the supporting script initialize.py
  - `./bqetl query schema deploy telemetry_derived.clients_first_seen_v2`
  - `python3 sql/moz-fx-data-shared-prod/analysis/clients_first_seen_v2_full/initiliaze.py --dataset=analysis --table=clients_first_seen_v2`
owners:
- lvargas@mozilla.com
labels:
  application: firefox
  incremental: true
  schedule: daily
  depends_on_past: true
  owner1: lvargas
scheduling:
  dag_name: bqetl_analytics_tables
  task_name: clients_first_seen_v2
  depends_on_past: true
  date_partition_parameter: null
  parameters:
  - submission_date:DATE:{{ds}}
bigquery:
  time_partitioning:
    type: day
    field: first_seen_date
    require_partition_filter: false
    expiration_days: null
  clustering:
    fields:
    - normalized_channel
    - sample_id
    - country
    - normalized_os
references: {}
