
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mozilla BigQuery ETL">
      
      
        <meta name="author" content="Mozilla Data Platform Team">
      
      
      <link rel="icon" href="../../favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.7">
    
    
      
        <title>norm - BigQuery ETL</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#norm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="BigQuery ETL" class="md-header__button md-logo" aria-label="BigQuery ETL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BigQuery ETL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              norm
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mozilla/bigquery-etl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bigquery-etl
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../mozdata/introduction/" class="md-tabs__link">
        Datasets
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link md-tabs__link--active">
        UDFs
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../cookbooks/common_workflows/" class="md-tabs__link">
        Cookbooks
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../bqetl/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BigQuery ETL" class="md-nav__button md-logo" aria-label="BigQuery ETL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BigQuery ETL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mozilla/bigquery-etl/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    mozilla/bigquery-etl
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Datasets
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Datasets" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Datasets
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" type="checkbox" id="__nav_2_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_1">
          Mozdata
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mozdata" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Mozdata
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/introduction/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/activity_stream/" class="md-nav__link">
        Activity Stream
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/amo_dev/" class="md-nav__link">
        AMO Stats Dev
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/amo_prod/" class="md-nav__link">
        AMO Stats Prod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/analysis/" class="md-nav__link">
        Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/bedrock/" class="md-nav__link">
        bedrock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/bergamot/" class="md-nav__link">
        Bergamot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/blpadi/" class="md-nav__link">
        Blocklist ADI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/burnham/" class="md-nav__link">
        burnham
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/contextual_services/" class="md-nav__link">
        contextual-services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/coverage/" class="md-nav__link">
        coverage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/default_browser_agent/" class="md-nav__link">
        default-browser-agent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/edge_validator/" class="md-nav__link">
        edge-validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/eng_workflow/" class="md-nav__link">
        eng-workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/fenix/" class="md-nav__link">
        Fenix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_accounts/" class="md-nav__link">
        Firefox Accounts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_desktop/" class="md-nav__link">
        firefox-desktop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_desktop_background_update/" class="md-nav__link">
        firefox-desktop-background-update
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_echo_show/" class="md-nav__link">
        Firefox Echo Show
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_fire_tv/" class="md-nav__link">
        Firefox Fire Tv
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_installer/" class="md-nav__link">
        firefox-installer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_ios/" class="md-nav__link">
        Firefox iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_launcher_process/" class="md-nav__link">
        firefox-launcher-process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_reality/" class="md-nav__link">
        Firefox Reality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_reality_pc/" class="md-nav__link">
        Firefox Reality Pc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/firefox_translations/" class="md-nav__link">
        firefox-translations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/focus_android/" class="md-nav__link">
        Focus Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/focus_ios/" class="md-nav__link">
        Focus Ios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/glean_dictionary/" class="md-nav__link">
        glean-dictionary
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/google_ads/" class="md-nav__link">
        Google_ads
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/internet_outages/" class="md-nav__link">
        Internet Outages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/klar_android/" class="md-nav__link">
        Klar Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/klar_ios/" class="md-nav__link">
        Klar Ios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/lockwise_android/" class="md-nav__link">
        Lockwise Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/lockwise_ios/" class="md-nav__link">
        Lockwise Ios
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mach/" class="md-nav__link">
        Mach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mdn_yari/" class="md-nav__link">
        mdn-yari
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/messaging_system/" class="md-nav__link">
        messaging-system
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mlhackweek_search/" class="md-nav__link">
        mlhackweek-search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mobile/" class="md-nav__link">
        mobile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozdata/" class="md-nav__link">
        mozdata
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozilla_lockbox/" class="md-nav__link">
        mozilla-lockbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozilla_mach/" class="md-nav__link">
        mozilla-mach
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozilla_vpn/" class="md-nav__link">
        Mozilla VPN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozilla_vpn_android/" class="md-nav__link">
        Mozilla Vpn Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozillavpn/" class="md-nav__link">
        mozillavpn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozphab/" class="md-nav__link">
        mozphab
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozregression/" class="md-nav__link">
        Mozregression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/mozza/" class="md-nav__link">
        mozza
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/operational_monitoring/" class="md-nav__link">
        Operational Monitoring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_bergamot/" class="md-nav__link">
        org-mozilla-bergamot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_connect_firefox/" class="md-nav__link">
        org-mozilla-connect-firefox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_fenix/" class="md-nav__link">
        org-mozilla-fenix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_fenix_nightly/" class="md-nav__link">
        org-mozilla-fenix-nightly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_fennec_aurora/" class="md-nav__link">
        org-mozilla-fennec-aurora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_firefox/" class="md-nav__link">
        org-mozilla-firefox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_firefox_beta/" class="md-nav__link">
        org-mozilla-firefox-beta
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_firefox_vpn/" class="md-nav__link">
        org-mozilla-firefox-vpn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_firefoxreality/" class="md-nav__link">
        org-mozilla-firefoxreality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_focus/" class="md-nav__link">
        org-mozilla-focus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_focus_beta/" class="md-nav__link">
        org-mozilla-focus-beta
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_focus_nightly/" class="md-nav__link">
        org-mozilla-focus-nightly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_fennec/" class="md-nav__link">
        org-mozilla-ios-fennec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_firefox/" class="md-nav__link">
        org-mozilla-ios-firefox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_firefoxbeta/" class="md-nav__link">
        org-mozilla-ios-firefoxbeta
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_focus/" class="md-nav__link">
        org-mozilla-ios-focus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_klar/" class="md-nav__link">
        org-mozilla-ios-klar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_ios_lockbox/" class="md-nav__link">
        org-mozilla-ios-lockbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_klar/" class="md-nav__link">
        org-mozilla-klar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_mozregression/" class="md-nav__link">
        org-mozilla-mozregression
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_reference_browser/" class="md-nav__link">
        org-mozilla-reference-browser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_tv_firefox/" class="md-nav__link">
        org-mozilla-tv-firefox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/org_mozilla_vrbrowser/" class="md-nav__link">
        org-mozilla-vrbrowser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/pine/" class="md-nav__link">
        pine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/pocket/" class="md-nav__link">
        pocket
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/reference_browser/" class="md-nav__link">
        Reference Browser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/regrets_reporter/" class="md-nav__link">
        regrets-reporter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/regrets_reporter_ucs/" class="md-nav__link">
        regrets-reporter-ucs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/relay/" class="md-nav__link">
        Firefox Relay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/search/" class="md-nav__link">
        Search
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/search_terms/" class="md-nav__link">
        Search Terms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/static/" class="md-nav__link">
        Static Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/stripe/" class="md-nav__link">
        Stripe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/subscription_platform/" class="md-nav__link">
        Subscription Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/telemetry/" class="md-nav__link">
        Telemetry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/treeherder/" class="md-nav__link">
        treeherder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/udf/" class="md-nav__link">
        User-Defined Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/udf_js/" class="md-nav__link">
        User-Defined Functions (Javascript)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/udf_js_lib/" class="md-nav__link">
        udf_js_lib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/udf_legacy/" class="md-nav__link">
        User-Defined Functions (Legacy)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/viu_politica/" class="md-nav__link">
        viu-politica
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mozdata/webpagetest/" class="md-nav__link">
        webpagetest
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          UDFs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="UDFs" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          UDFs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_1" type="checkbox" id="__nav_3_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_1">
          Mozfun
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mozfun" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Mozfun
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        mozfun
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bits28/" class="md-nav__link">
        bits28
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bytes/" class="md-nav__link">
        bytes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../datetime_util/" class="md-nav__link">
        datetime_util.fxa_parse_date
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../event_analysis/" class="md-nav__link">
        event_analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glam/" class="md-nav__link">
        Glam
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../glean/" class="md-nav__link">
        glean
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hist/" class="md-nav__link">
        hist
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iap/" class="md-nav__link">
        iap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        json
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../map/" class="md-nav__link">
        map
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          norm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        norm
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extract_version-udf" class="md-nav__link">
    extract_version (UDF)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get_windows_info-udf" class="md-nav__link">
    get_windows_info (UDF)
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stats/" class="md-nav__link">
        stats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vpn/" class="md-nav__link">
        vpn
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Cookbooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Cookbooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Cookbooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbooks/common_workflows/" class="md-nav__link">
        Common workflows
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbooks/creating_a_derived_dataset/" class="md-nav__link">
        Creating a derived dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cookbooks/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bqetl/" class="md-nav__link">
        bqetl CLI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/recommended_practices/" class="md-nav__link">
        Recommended practices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/incremental/" class="md-nav__link">
        Incremental queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/scheduling/" class="md-nav__link">
        Scheduling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/public_data/" class="md-nav__link">
        Public data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/airflow_tags/" class="md-nav__link">
        Airflow Tags
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extract_version-udf" class="md-nav__link">
    extract_version (UDF)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get_windows_info-udf" class="md-nav__link">
    get_windows_info (UDF)
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="norm">norm</h1>
<p>Functions for normalizing data.</p>
<h2 id="extract_version-udf">extract_version (UDF)</h2>
<p>Extracts numeric version data from a version string like
<code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code>.</p>
<p>Note: Non-zero minor and patch versions will be floating point <code>Numeric</code>.</p>
<p>Usage:</p>
<pre><code class="language-sql">SELECT
    mozfun.norm.extract_version(version_string, 'major') as major_version,
    mozfun.norm.extract_version(version_string, 'minor') as minor_version,
    mozfun.norm.extract_version(version_string, 'patch') as patch_version
</code></pre>
<p>Example using <code>"96.05.01"</code>:</p>
<pre><code class="language-sql">SELECT
    mozfun.norm.extract_version('96.05.01', 'major') as major_version, -- 96
    mozfun.norm.extract_version('96.05.01', 'minor') as minor_version, -- 5
    mozfun.norm.extract_version('96.05.01', 'patch') as patch_version  -- 1
```[Source](https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/extract_version)  |  [Edit](https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/extract_version/metadata.yaml)



## browser_version_info (UDF)

Adds metadata related to the browser version in a struct.

This is a temporary solution that allows browser version analysis.
It should eventually be replaced with one or more browser version tables
that serves as a source of truth for version releases.


[Source](https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/browser_version_info)  |  [Edit](https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/browser_version_info/metadata.yaml)



## diff_months (UDF)

Determine the number of whole months after grace period between start and end. Month is dependent on timezone, so start and end must both be datetimes, or both be dates, in the correct timezone. Grace period can be used to account for billing delay, usually 1 day, and is counted after months. When inclusive is FALSE, start and end are not included in whole months.
For example, diff_months(start =&gt; '2021-01-01', end =&gt; '2021-03-01', grace_period =&gt; INTERVAL 0 day, inclusive =&gt; FALSE) returns 1, because start plus two months plus grace period is not less than end. Changing inclusive to TRUE returns 2, because start plus two months plus grace period is less than or equal to end. diff_months(start =&gt; '2021-01-01', end =&gt; '2021-03-02 00:00:00.000001', grace_period =&gt; INTERVAL 1 DAY, inclusive =&gt; FALSE) returns 2, because start plus two months plus grace period is less than end.


[Source](https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/diff_months)  |  [Edit](https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/diff_months/metadata.yaml)



## get_earliest_value (UDF)

This UDF returns the earliest not-null value from a list of values
and their corresponding timestamp.

The function will return the first value in the input array,
that is not null and has the earliest timestamp.

Because there may be more than one value on the same date e.g. more
than one value reported by different pings on the same date, the dates
must be given as TIMESTAMPS and the values as STRING.


Usage:

```sql
SELECT
   mozfun.norm.get_earliest_value(ARRAY&lt;STRUCT&lt;value STRING, value_date DATETIME&gt;&gt;) AS &lt;alias&gt;
</code></pre>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/get_earliest_value">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/get_earliest_value/metadata.yaml">Edit</a></p>
<h2 id="get_windows_info-udf">get_windows_info (UDF)</h2>
<p>Exract the name, the version name, the version number, and the build number
corresponding to a Microsoft Windows operating system version string in the
form of <number>.<number>.<number> or <number>.<number>.<number>.<number>
for most release versions of Windows after 2007.</p>
<h1 id="windows-names-versions-and-builds">Windows Names, Versions, and Builds</h1>
<h2 id="summary">Summary</h2>
<p>This function is primarily designed to parse the field <code>os_version</code> in table <code>mozdata.default_browser_agent.default_browser</code>. Given a Microsoft Windows OS version string, the function returns the name of the operating system, the version name, the version number, and the build number corresponding to the operating system. As of November 2022, the parser can handle 99.89% of the <code>os_version</code> values collected in table <code>mozdata.default_browser_agent.default_browser</code>.</p>
<h3 id="status-as-of-november-2022">Status as of November 2022</h3>
<p>As of November 2022, the expected valid values of <code>os_version</code> are either <code>x.y.z</code> or <code>w.x.y.z</code> where <code>w</code>, <code>x</code>, <code>y</code>, and <code>z</code> are integers.</p>
<p>As of November 2022, the return values for Windows 10 and Windows 11 are based on <a href="https://learn.microsoft.com/en-us/windows/release-health/release-information">Windows 10 release information</a> and <a href="https://learn.microsoft.com/en-us/windows/release-health/windows11-release-information">Windows 11 release information</a>. For 3-number version strings, the parser assumes the valid values of <code>z</code> in <code>x.y.z</code> are at most 5 digits in length. For 4-number version strings, the parser assumes the valid values of <code>z</code> in <code>w.x.y.z</code> are at most 6 digits in length. The function makes an educated effort to handle Windows Vista, Windows 7, Windows 8, and Windows 8.1 information, but does not guarantee the return values are absolutely accurate. The function assumes the presence of undocumented non-release versions of Windows 10 and Windows 11, and will return an estimated name, version number, build number but not the version name. The function does not handle other versions of Windows.</p>
<p>As of November 2022, the parser currently handles just over 99.89% of data in the field <code>os_version</code> in table <code>mozdata.default_browser_agent.default_browser</code>.</p>
<h3 id="build-number-conventions">Build number conventions</h3>
<p>Note: Microsoft convention for build numbers for Windows 10 and 11 include two numbers, such as build number <code>22621.900</code> for version <code>22621</code>. The first number repeats the version number and the second number uniquely identifies the build within the version. To simplify data processing and data analysis, this function returns the second unique identifier as an integer instead of returning the full build number as a string.</p>
<h2 id="example-usage">Example usage</h2>
<pre><code class="language-sql">SELECT
  `os_version`,
  mozfun.norm.get_windows_info(`os_version`) AS windows_info
FROM `mozdata.default_browser_agent.default_browser`
WHERE `submission_timestamp` &gt; (CURRENT_TIMESTAMP() - INTERVAL 7 DAY) AND LEFT(document_id, 2) = '00'
LIMIT 1000
</code></pre>
<h2 id="mapping">Mapping</h2>
<table>
<thead>
<tr>
<th>os_version</th>
<th>windows_name</th>
<th>windows_version_name</th>
<th>windows_version_number</th>
<th>windows_build_number</th>
</tr>
</thead>
<tbody>
<tr>
<td>6.0.z</td>
<td>Windows Vista</td>
<td>6.0</td>
<td>6.0</td>
<td>z</td>
</tr>
<tr>
<td>6.1.z</td>
<td>Windows 7</td>
<td>7.0</td>
<td>6.1</td>
<td>z</td>
</tr>
<tr>
<td>6.2.z</td>
<td>Windows 8</td>
<td>8.0</td>
<td>6.2</td>
<td>z</td>
</tr>
<tr>
<td>6.3.z</td>
<td>Windows 8.1</td>
<td>8.1</td>
<td>6.3</td>
<td>z</td>
</tr>
<tr>
<td>10.0.10240.z</td>
<td>Windows 10</td>
<td>1507</td>
<td>10240</td>
<td>z</td>
</tr>
<tr>
<td>10.0.10586.z</td>
<td>Windows 10</td>
<td>1511</td>
<td>10586</td>
<td>z</td>
</tr>
<tr>
<td>10.0.14393.z</td>
<td>Windows 10</td>
<td>1607</td>
<td>14393</td>
<td>z</td>
</tr>
<tr>
<td>10.0.15063.z</td>
<td>Windows 10</td>
<td>1703</td>
<td>15063</td>
<td>z</td>
</tr>
<tr>
<td>10.0.16299.z</td>
<td>Windows 10</td>
<td>1709</td>
<td>16299</td>
<td>z</td>
</tr>
<tr>
<td>10.0.17134.z</td>
<td>Windows 10</td>
<td>1803</td>
<td>17134</td>
<td>z</td>
</tr>
<tr>
<td>10.0.17763.z</td>
<td>Windows 10</td>
<td>1809</td>
<td>17763</td>
<td>z</td>
</tr>
<tr>
<td>10.0.18362.z</td>
<td>Windows 10</td>
<td>1903</td>
<td>18362</td>
<td>z</td>
</tr>
<tr>
<td>10.0.18363.z</td>
<td>Windows 10</td>
<td>1909</td>
<td>18363</td>
<td>z</td>
</tr>
<tr>
<td>10.0.19041.z</td>
<td>Windows 10</td>
<td>2004</td>
<td>19041</td>
<td>z</td>
</tr>
<tr>
<td>10.0.19042.z</td>
<td>Windows 10</td>
<td>20H2</td>
<td>19042</td>
<td>z</td>
</tr>
<tr>
<td>10.0.19043.z</td>
<td>Windows 10</td>
<td>21H1</td>
<td>19043</td>
<td>z</td>
</tr>
<tr>
<td>10.0.19044.z</td>
<td>Windows 10</td>
<td>21H2</td>
<td>19044</td>
<td>z</td>
</tr>
<tr>
<td>10.0.19045.z</td>
<td>Windows 10</td>
<td>22H2</td>
<td>19045</td>
<td>z</td>
</tr>
<tr>
<td>10.0.y.z</td>
<td>Windows 10</td>
<td>UNKNOWN</td>
<td>y</td>
<td>z</td>
</tr>
<tr>
<td>10.0.22000.z</td>
<td>Windows 11</td>
<td>21H2</td>
<td>22000</td>
<td>z</td>
</tr>
<tr>
<td>10.0.22621.z</td>
<td>Windows 11</td>
<td>22H2</td>
<td>22621</td>
<td>z</td>
</tr>
<tr>
<td>10.0.y.z</td>
<td>Windows 11</td>
<td>UNKNOWN</td>
<td>y</td>
<td>z</td>
</tr>
<tr>
<td>all other values</td>
<td>(null)</td>
<td>(null)</td>
<td>(null)</td>
<td>(null)</td>
</tr>
<tr>
<td><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/get_windows_info">Source</a></td>
<td><a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/get_windows_info/metadata.yaml">Edit</a></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="fenix_app_info-udf">fenix_app_info (UDF)</h2>
<p>Returns canonical, human-understandable identification info for Fenix sources.</p>
<p>The Glean telemetry library for Android by design routes pings based
on the Play Store appId value of the published application.
As of August 2020, there have been 5 separate Play Store appId
 values associated with different builds of Fenix,
 each corresponding to different datasets in BigQuery,
and the mapping of appId to logical app names
(Firefox vs. Firefox Preview) and channel names
 (nightly, beta, or release) has changed over time; see the
<a href="&lt;https://docs.google.com/spreadsheets/d/18PzkzZxdpFl23__-CIO735NumYDqu7jHpqllo0sBbPA/edit#gid=0">spreadsheet of naming history for Mozilla's mobile browsers</a>.&gt;</p>
<p>This function is intended as the source of truth for how to map a
specific ping in BigQuery to a logical app names and channel.
It should be expected that the output of this function may evolve
over time. If we rename a product or channel, we may choose to
update the values here so that analyses consistently get the new name.</p>
<p>The first argument (<code>app_id</code>) can be fairly fuzzy; it is tolerant
of actual Google Play Store appId values like 'org.mozilla.firefox_beta'
(mix of periods and underscores) as well as BigQuery dataset names
with suffixes like 'org_mozilla_firefox_beta_stable'.</p>
<p>The second argument (<code>app_build_id</code>) should be the value
in client_info.app_build.</p>
<p>The function returns a <code>STRUCT</code> that contains the logical <code>app_name</code>
and <code>channel</code> as well as the Play Store <code>app_id</code> in the canonical
form which would appear in Play Store URLs.</p>
<p>Note that the naming of Fenix applications changed on 2020-07-03,
so to get a continuous view of the pings associated with a logical
app channel, you may need to union together tables from multiple
BigQuery datasets. To see data for all Fenix channels together, it
is necessary to union together tables from all 5 datasets.
For basic usage information, consider using
<code>telemetry.fenix_clients_last_seen</code> which already handles the
union. Otherwise, see the example below as a template for how
construct a custom union.</p>
<p>Mapping of channels to datasets:</p>
<ul>
<li>release: <code>org_mozilla_firefox</code></li>
<li>beta: <code>org_mozilla_firefox_beta</code> (current) and <code>org_mozilla_fenix</code></li>
<li>nightly: <code>org_mozilla_fenix</code> (current), <code>org_mozilla_fennec_aurora</code>,
and <code>org_mozilla_fenix_nightly</code></li>
</ul>
<pre><code class="language-sql">-- Example of a query over all Fenix builds advertised as &quot;Firefox Beta&quot;
CREATE TEMP FUNCTION extract_fields(app_id STRING, m ANY TYPE) AS (
  (
    SELECT AS STRUCT
      m.submission_timestamp,
      m.metrics.string.geckoview_version,
      mozfun.norm.fenix_app_info(app_id, m.client_info.app_build).*
  )
);

WITH base AS (
  SELECT
    extract_fields('org_mozilla_firefox_beta', m).*
  FROM
    org_mozilla_firefox_beta.metrics AS m
  UNION ALL
  SELECT
    extract_fields('org_mozilla_fenix', m).*
  FROM
    org_mozilla_fenix.metrics AS m
)
SELECT
  DATE(submission_timestamp) AS submission_date,
  geckoview_version,
  COUNT(*)
FROM
  base
WHERE
  app_name = 'Fenix'  -- excludes 'Firefox Preview'
  AND channel = 'beta'
  AND DATE(submission_timestamp) = '2020-08-01'
GROUP BY
  submission_date,
  geckoview_version
</code></pre>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/fenix_app_info">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/fenix_app_info/metadata.yaml">Edit</a></p>
<h2 id="fenix_build_to_datetime-udf">fenix_build_to_datetime (UDF)</h2>
<p>Convert the Fenix client_info.app_build-format string to
a DATETIME. May return NULL on failure.</p>
<p>Fenix originally used an
<a href="&lt;https://github.com/mozilla-mobile/fenix/blob/c7283447/automation/gradle/versionCode.gradle#L12-L16">8-digit app_build format</a>&gt;</p>
<p>In short it is <code>yDDDHHmm</code>:</p>
<ul>
<li>y is years since 2018</li>
<li>DDD is day of year, 0-padded, 001-366</li>
<li>HH is hour of day, 00-23</li>
<li>mm is minute of hour, 00-59</li>
</ul>
<p>The last date seen with an 8-digit build ID is 2020-08-10.</p>
<p>Newer builds use a
<a href="&lt;https://github.com/mozilla-mobile/fenix/blob/e6ee13dc/buildSrc/src/main/java/Config.kt#L55-L112">10-digit format</a>&gt;
where the integer represents a pattern consisting of 32 bits.
The 17 bits starting 13 bits from the left represent a number of hours since
UTC midnight beginning 2014-12-28.</p>
<p>This function tolerates both formats.</p>
<p>After using this you may wish to <code>DATETIME_TRUNC(result, DAY)</code> for
grouping by build date.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/fenix_build_to_datetime">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/fenix_build_to_datetime/metadata.yaml">Edit</a></p>
<h2 id="metadata-udf">metadata (UDF)</h2>
<p>Accepts a pipeline metadata struct as input and returns a modified struct that includes a few parsed or normalized variants of the input metadata fields.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/metadata">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/metadata/metadata.yaml">Edit</a></p>
<h2 id="os-udf">os (UDF)</h2>
<p>Normalize an operating system string to one of the three major desktop
platforms, one of the two major mobile platforms, or "Other".</p>
<p>This is a reimplementation of
<a href="&lt;https://github.com/mozilla/gcp-ingestion/blob/a6928fb089f1652856147c4605df715f327edfcd/ingestion-beam/src/main/java/com/mozilla/telemetry/transforms/NormalizeAttributes.java#L52-L74">logic used in the data pipeline</a>&gt;
  to populate <code>normalized_os</code>.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/os">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/os/metadata.yaml">Edit</a></p>
<h2 id="glean_baseline_client_info-udf">glean_baseline_client_info (UDF)</h2>
<p>Accepts a glean client_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/glean_baseline_client_info">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/glean_baseline_client_info/metadata.yaml">Edit</a></p>
<h2 id="glean_ping_info-udf">glean_ping_info (UDF)</h2>
<p>Accepts a glean ping_info struct as input and returns a modified struct that includes a few parsed or normalized variants of the input fields.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/glean_ping_info">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/glean_ping_info/metadata.yaml">Edit</a></p>
<h2 id="vpn_attribution-udf">vpn_attribution (UDF)</h2>
<p>Accepts vpn attribution fields as input and returns a struct of normalized fields.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/vpn_attribution">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/vpn_attribution/metadata.yaml">Edit</a></p>
<h2 id="windows_version_info-udf">windows_version_info (UDF)</h2>
<p>Given an unnormalized set off Windows identifiers, return a friendly version
of the operating system name.</p>
<p>Requires os, os_version and windows_build_number.</p>
<p>E.G. from windows_build_number &gt;= 22000 return Windows 11</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/windows_version_info">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/windows_version_info/metadata.yaml">Edit</a></p>
<h2 id="product_info-udf">product_info (UDF)</h2>
<p>Returns a normalized <code>app_name</code> and <code>canonical_app_name</code>
for a product based on <code>legacy_app_name</code> and <code>normalized_os</code> values.
Thus, this function serves as a bridge to get from legacy application
identifiers to the consistent identifiers we are using for reporting in 2021.</p>
<p>As of 2021, most Mozilla products are sending telemetry via the Glean SDK,
with Glean telemetry in active development for desktop Firefox as well. The
<code>probeinfo</code> API is the single source of truth for metadata about applications
sending Glean telemetry; the values for <code>app_name</code> and
<code>canonical_app_name</code> returned here correspond to the "end-to-end identifier"
values documented in
<a href="https://mozilla.github.io/probe-scraper/#operation/getAppListings">the v2 Glean app listings endpoint
</a>.
For non-Glean telemetry, we provide values in the same style to provide
continuity as we continue the migration to Glean.</p>
<p>For legacy telemetry pings like <code>main</code> ping for desktop and <code>core</code> ping for
mobile products, the <code>legacy_app_name</code> given as input to this function
should come from the submission URI (stored as
<code>metadata.uri.app_name</code> in BigQuery ping tables).
For Glean pings, we have invented <code>product</code> values that can be passed
in to this function as the <code>legacy_app_name</code> parameter.</p>
<p>The returned <code>app_name</code> values are intended to be
readable and unambiguous, but short and easy to type.
They are suitable for use as a key in derived tables.
<code>product</code> is a deprecated field that was similar in intent.</p>
<p>The returned <code>canonical_app_name</code> is more verbose and is suited for displaying
in visualizations. <code>canonical_name</code> is a synonym that we provide for
historical compatibility with previous versions of this function.</p>
<p>The returned struct also contains boolean <code>contributes_to_2021_kpi</code> as the
canonical reference for whether the given application is included in KPI
reporting. Additional fields may be added for future years.</p>
<p>The <code>normalized_os</code> value that's passed in should be the top-level
<code>normalized_os</code> value present in any ping table or you may want
to wrap a raw value in <code>mozfun.norm.os</code>
like <code>mozfun.norm.product_info(app_name, mozfun.norm.os(os))</code>.</p>
<p>This function also tolerates passing in a <code>product</code> value as
<code>legacy_app_name</code> so that this function is still useful for derived tables
which have thrown away the raw <code>app_name</code> value from legacy pings.</p>
<p>The mappings are as follows:</p>
<table>
<thead>
<tr>
<th>legacy_app_name</th>
<th>normalized_os</th>
<th>app_name</th>
<th>product</th>
<th>canonical_app_name</th>
<th>2019</th>
<th>2020</th>
<th>2021</th>
</tr>
</thead>
<tbody>
<tr>
<td>Firefox</td>
<td>*</td>
<td>firefox_desktop</td>
<td>Firefox</td>
<td>Firefox for Desktop</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Fenix</td>
<td>Android</td>
<td>fenix</td>
<td>Fenix</td>
<td>Firefox for Android (Fenix)</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Fennec</td>
<td>Android</td>
<td>fennec</td>
<td>Fennec</td>
<td>Firefox for Android (Fennec)</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Firefox Preview</td>
<td>Android</td>
<td>firefox_preview</td>
<td>Firefox Preview</td>
<td>Firefox Preview for Android</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Fennec</td>
<td>iOS</td>
<td>firefox_ios</td>
<td>Firefox iOS</td>
<td>Firefox for iOS</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>FirefoxForFireTV</td>
<td>Android</td>
<td>firefox_fire_tv</td>
<td>Firefox Fire TV</td>
<td>Firefox for Fire TV</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>FirefoxConnect</td>
<td>Android</td>
<td>firefox_connect</td>
<td>Firefox Echo</td>
<td>Firefox for Echo Show</td>
<td>true</td>
<td>true</td>
<td>false</td>
</tr>
<tr>
<td>Zerda</td>
<td>Android</td>
<td>firefox_lite</td>
<td>Firefox Lite</td>
<td>Firefox Lite</td>
<td>true</td>
<td>true</td>
<td>false</td>
</tr>
<tr>
<td>Zerda_cn</td>
<td>Android</td>
<td>firefox_lite_cn</td>
<td>Firefox Lite CN</td>
<td>Firefox Lite (China)</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>Focus</td>
<td>Android</td>
<td>focus_android</td>
<td>Focus Android</td>
<td>Firefox Focus for Android</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Focus</td>
<td>iOS</td>
<td>focus_ios</td>
<td>Focus iOS</td>
<td>Firefox Focus for iOS</td>
<td>true</td>
<td>true</td>
<td>true</td>
</tr>
<tr>
<td>Klar</td>
<td>Android</td>
<td>klar_android</td>
<td>Klar Android</td>
<td>Firefox Klar for Android</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>Klar</td>
<td>iOS</td>
<td>klar_ios</td>
<td>Klar iOS</td>
<td>Firefox Klar for iOS</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td>Lockbox</td>
<td>Android</td>
<td>lockwise_android</td>
<td>Lockwise Android</td>
<td>Lockwise for Android</td>
<td>true</td>
<td>true</td>
<td>false</td>
</tr>
<tr>
<td>Lockbox</td>
<td>iOS</td>
<td>lockwise_ios</td>
<td>Lockwise iOS</td>
<td>Lockwise for iOS</td>
<td>true</td>
<td>true</td>
<td>false</td>
</tr>
<tr>
<td>FirefoxReality*</td>
<td>Android</td>
<td>firefox_reality</td>
<td>Firefox Reality</td>
<td>Firefox Reality</td>
<td>false</td>
<td>false</td>
<td>false</td>
</tr>
<tr>
<td><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/product_info">Source</a></td>
<td><a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/product_info/metadata.yaml">Edit</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="truncate_version-udf">truncate_version (UDF)</h2>
<p>Truncates a version string like <code>&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</code> to
either the major or minor version. The return value is <code>NUMERIC</code>,
which means that you can sort the results without fear (e.g. 100
will be categorized as greater than 80, which isn't the case when
sorting lexigraphically).</p>
<p>For example, "5.1.0" would be translated to <code>5.1</code> if the parameter is
"minor" or <code>5</code> if the parameter is major.</p>
<p>If the version is only a major and/or minor version, then it will be left
unchanged (for example "10" would stay as <code>10</code> when run through this
function, no matter what the arguments).</p>
<p>This is useful for grouping Linux and Mac operating system versions inside
aggregate datasets or queries where there may be many different patch
releases in the field.</p>
<p><a href="https://github.com/mozilla/bigquery-etl/blob/generated-sql/sql/mozfun/norm/truncate_version">Source</a>  |  <a href="https://github.com/mozilla/bigquery-etl/edit/generated-sql/sql/mozfun/norm/truncate_version/metadata.yaml">Edit</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../map/" class="md-footer__link md-footer__link--prev" aria-label="Previous: map" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              map
            </div>
          </div>
        </a>
      
      
        
        <a href="../stats/" class="md-footer__link md-footer__link--next" aria-label="Next: stats" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              stats
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8492ddcf.min.js"></script>
      
    
  </body>
</html>